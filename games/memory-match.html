<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Memory Card Match — Concentration Game</title>
  <style>
    :root{
      --bg:#0f1724;
      --card-bg:#f8fafc;
      --accent:#06b6d4;
      --matched:#10b981;
      --text:#e6eef6;
      --card-size:calc(22vmin);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,var(--bg),#071026 80%);color:var(--text);display:flex;align-items:center;justify-content:center;padding:24px}

    .game-wrap{width:min(980px,100%);}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    h1{font-size:20px;margin:0}
    .controls{display:flex;gap:10px;align-items:center}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.08);color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
    .btn:hover{border-color:rgba(255,255,255,0.16)}

    .stats{display:flex;gap:12px;align-items:center;font-size:14px}
    .board{display:grid;gap:12px;justify-items:center}
    /* responsive grid: 4x4 for small, 6x4 for larger */
    @media (min-width:640px){
      .board{grid-template-columns:repeat(6, var(--card-size));}
      :root{--card-size:calc(14vmin);} 
    }
    @media (max-width:639px){
      .board{grid-template-columns:repeat(4, var(--card-size));}
      :root{--card-size:calc(22vmin);} 
    }

    .card{width:var(--card-size);height:var(--card-size);perspective:1000px}
    .inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform 500ms cubic-bezier(.2,.9,.3,1)}
    .card.is-flipped .inner{transform:rotateY(180deg)}

    .face{position:absolute;inset:0;border-radius:12px;backface-visibility:hidden;display:flex;align-items:center;justify-content:center;font-size:calc(var(--card-size) * 0.45);user-select:none}

    .face.front{background:linear-gradient(180deg,#ffffff,#f1f5f9);color:#0b1220;border:1px solid rgba(12,18,28,0.06);transform:rotateY(180deg)}
    .face.back{background:linear-gradient(180deg,#08303a,#062530);color:var(--text);border:1px solid rgba(255,255,255,0.04)}

    .face.back .pattern{font-size:18px;opacity:.9}

    .card.matched .inner{box-shadow:0 6px 20px rgba(16,185,129,0.12)}

    .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(2,6,23,0.65),rgba(2,6,23,0.9));backdrop-filter:blur(2px);}
    .modal{background:linear-gradient(180deg,#062b35,#04303b);padding:28px;border-radius:16px;border:1px solid rgba(255,255,255,0.05);min-width:280px;text-align:center}
    .modal h2{margin:0 0 8px 0}
    .small{font-size:13px;opacity:.9}

    footer{margin-top:14px;color:rgba(255,255,255,0.6);font-size:13px;text-align:center}
  </style>
</head>
<body>
  <div class="game-wrap">
    <header>
      <h1>Memory Card Match</h1>
      <div class="controls">
        <div class="stats">
          <div class="moves">Moves: <strong id="moves">0</strong></div>
          <div class="time">Time: <strong id="time">0s</strong></div>
        </div>
        <button id="restart" class="btn">Restart</button>
      </div>
    </header>

    <main>
      <section id="board" class="board" aria-live="polite" aria-label="Memory board"></section>
    </main>

    <footer>
      Flip over two cards to find matching pairs. Layout randomizes each game. Made with love by BackonBITZ.
    </footer>
  </div>

  <template id="card-template">
    <div class="card" role="button" tabindex="0">
      <div class="inner">
        <div class="face front" aria-hidden="true"><span class="symbol"></span></div>
        <div class="face back" aria-hidden="true"><div class="pattern">?</div></div>
      </div>
    </div>
  </template>

  <script>
    // icons/emojis used for the cards (you can replace these with images if you like)
    const ICONS = [
      '🍎','🍊','🍇','🍓','🍉','🍒','🥝','🍍','🥥','🍑','🍋','🍐'
    ];

    const boardEl = document.getElementById('board');
    const movesEl = document.getElementById('moves');
    const timeEl = document.getElementById('time');
    const restartBtn = document.getElementById('restart');
    const template = document.getElementById('card-template');

    let firstCard = null;
    let secondCard = null;
    let lockBoard = false;
    let moves = 0;
    let matchedPairs = 0;
    let totalPairs = 0;
    let timer = null;
    let seconds = 0;

    function shuffle(array){
      // Fisher-Yates
      for(let i=array.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [array[i],array[j]] = [array[j],array[i]];
      }
      return array;
    }

    function buildDeck(pairCount){
      const icons = ICONS.slice(0,pairCount);
      const deck = icons.concat(icons).map(icon => ({icon, id:crypto.randomUUID()}));
      return shuffle(deck);
    }

    function startTimer(){
      clearInterval(timer);
      seconds = 0;
      timeEl.textContent = seconds + 's';
      timer = setInterval(()=>{ seconds++; timeEl.textContent = seconds + 's'; }, 1000);
    }

    function stopTimer(){
      clearInterval(timer);
      timer = null;
    }

    function resetBoard(){
      firstCard = null; secondCard = null; lockBoard = false; moves = 0; matchedPairs = 0;
      movesEl.textContent = moves;
      boardEl.innerHTML = '';
    }

    function render(deck){
      resetBoard();
      totalPairs = deck.length/2;
      deck.forEach(cardData => {
        const frag = template.content.cloneNode(true);
        const card = frag.querySelector('.card');
        const symbol = frag.querySelector('.symbol');
        symbol.textContent = cardData.icon;
        card.dataset.icon = cardData.icon;
        card.dataset.id = cardData.id;

        // click & keyboard handlers
        card.addEventListener('click', () => tryFlip(card));
        card.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); tryFlip(card); }
        });

        boardEl.appendChild(frag);
      });
    }

    function tryFlip(card){
      if(lockBoard) return;
      if(card === firstCard) return; // clicking same card
      // can't flip a matched card
      if(card.classList.contains('matched')) return;

      card.classList.add('is-flipped');

      if(!firstCard){
        firstCard = card;
        if(moves === 0 && !timer) startTimer();
        return;
      }

      secondCard = card;
      moves++;
      movesEl.textContent = moves;
      lockBoard = true; // prevent more flips while checking

      const a = firstCard.dataset.icon;
      const b = secondCard.dataset.icon;

      if(a === b){
        // match!
        firstCard.classList.add('matched');
        secondCard.classList.add('matched');
        matchedPairs++;
        firstCard = null; secondCard = null; lockBoard = false;

        if(matchedPairs === totalPairs){
          stopTimer();
          setTimeout(()=> showWinModal(), 500);
        }
      } else {
        // not a match — flip back after animation time
        setTimeout(()=>{
          firstCard.classList.remove('is-flipped');
          secondCard.classList.remove('is-flipped');
          firstCard = null; secondCard = null; lockBoard = false;
        }, 700);
      }
    }

    function showWinModal(){
      const overlay = document.createElement('div');
      overlay.className = 'overlay';
      overlay.innerHTML = `<div class="modal" role="dialog" aria-modal="true">
        <h2>Well done!</h2>
        <p class="small">You finished in ${moves} moves and ${seconds} seconds.</p>
        <div style="margin-top:12px"><button id="play-again" class="btn">Play again</button></div>
      </div>`;
      document.body.appendChild(overlay);
      document.getElementById('play-again').focus();
      document.getElementById('play-again').addEventListener('click', ()=>{ overlay.remove(); startNewGame(); });
      overlay.addEventListener('click',(e)=>{ if(e.target===overlay) { overlay.remove(); startNewGame(); } });
    }

    function startNewGame(){
      // choose number of pairs based on available ICONS and viewport
      const small = window.matchMedia('(max-width:639px)').matches;
      const pairCount = small ? 8 : Math.min(ICONS.length, 12); // 4x4 or 6x4
      const deck = buildDeck(pairCount);
      render(deck);
      movesEl.textContent = 0;
      timeEl.textContent = '0s';
      stopTimer();
    }

    restartBtn.addEventListener('click', startNewGame);

    // initialize
    startNewGame();

    // accessibility: allow spacebar/enter to trigger on focused card
    document.addEventListener('keyup', (e)=>{
      if(e.key === 'r' || e.key === 'R') startNewGame();
    });

    // make sure layout re-builds when orientation or size changes (keeps sensible pair count)
    window.addEventListener('resize', ()=>{
      // small debounce
      clearTimeout(window._resizeTimeout);
      window._resizeTimeout = setTimeout(()=> startNewGame(), 350);
    });
  </script>
</body>
</html>
